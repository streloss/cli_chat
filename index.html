<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>CLI Chat</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script defer src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<style>
* { box-sizing:border-box; margin:0; padding:0; }
body { background:#0a0a0a; color:#e0e0e0; font-family:monospace; height:100vh; overflow:hidden; }
#top-bar { position:fixed; top:0; left:0; right:0; height:48px; background:#111; border-bottom:1px solid #222; display:flex; align-items:center; justify-content:space-between; padding:0 16px; z-index:20; }
#menu-btn { cursor:pointer; font-size:22px; color:#0af; }
#title { font-size:16px; font-weight:bold; }
#lobby-icon { cursor:pointer; font-size:20px; color:#0f0; }
#sidebar { position:fixed; left:0; top:48px; bottom:0; width:260px; background:#111; border-right:1px solid #222; padding:20px; transform:translateX(-100%); transition:transform 0.3s ease; z-index:15; overflow-y:auto; }
#sidebar.open { transform:translateX(0); }
.sidebar-title { font-size:15px; color:#aaa; margin-bottom:12px; }
#friends-list, #rooms-list { font-size:14px; line-height:1.6; }
.friend, .room { margin:6px 0; cursor:pointer; }
#friends-input, #new-room-password { width:100%; background:#1a1a1a; color:#fff; border:1px solid #333; border-radius:4px; padding:8px; margin-top:8px; }
#add-friend-btn, #create-room-btn { background:#0af; color:#0a0a0a; border:none; padding:8px 12px; border-radius:4px; cursor:pointer; margin-top:8px; width:100%; }
#terminal { padding:56px 16px 100px; height:100vh; overflow-y:auto; background:#0a0a0a; }
.message { margin:10px 0; white-space:pre-wrap; word-break:break-word; }
.time { color:#555; margin-right:6px; }
.creator-tag { color:#ff6666; font-size:14px; font-weight:bold; margin-right:6px; }
.nick { font-weight:bold; margin-right:4px; }
.separator { color:#555; margin:0 4px; }
#input-area { position:fixed; bottom:36px; left:0; right:0; padding:12px 16px; background:#0a0a0a; border-top:1px solid #222; display:flex; gap:8px; }
#input { flex:1; background:#1a1a1a; color:#fff; border:1px solid #333; border-radius:8px; padding:12px 16px; font-size:16px; outline:none; }
#send-btn { background:#0af; color:#000; border:none; padding:0 20px; border-radius:8px; cursor:pointer; font-weight:bold; }
#status-bar { position:fixed; bottom:0; left:0; right:0; height:36px; background:#111; color:#888; font-size:13px; display:flex; align-items:center; justify-content:space-between; padding:0 16px; border-top:1px solid #222; }
#status { flex:1; }
#online { cursor:pointer; color:#0f0; font-weight:bold; }
#onlineList { display:none; position:absolute; bottom:36px; left:50%; transform:translateX(-50%); background:#111; border:1px solid #333; border-radius:8px; padding:12px; width:320px; max-height:400px; overflow-y:auto; box-shadow:0 10px 30px rgba(0,0,0,0.7); z-index:30; }
#typing { position:fixed; bottom:76px; left:16px; color:#777; font-size:13px; display:none; }
</style>
</head>
<body>

<div id="top-bar">
  <span id="menu-btn">‚ò∞</span>
  <div id="title">CLI Chat</div>
  <span id="lobby-icon">üè†</span>
</div>

<div id="sidebar">
  <div class="sidebar-title">–î—Ä—É–∑—å—è</div>
  <div id="friends-list"></div>
  <input id="friends-input" placeholder="–î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞ (–Ω–∏–∫)">
  <button id="add-friend-btn">–î–æ–±–∞–≤–∏—Ç—å</button>

  <div class="sidebar-title" style="margin-top:32px">–õ–æ–±–±–∏</div>
  <div id="rooms-list"></div>
  <input id="new-room-password" placeholder="–ü–∞—Ä–æ–ª—å –¥–ª—è –Ω–æ–≤–æ–π –∫–æ–º–Ω–∞—Ç—ã">
  <button id="create-room-btn">–°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
</div>

<div id="terminal"></div>

<div id="input-area">
  <input id="input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ... (Enter)" autofocus>
  <button id="send-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</div>

<div id="status-bar">
  <div id="status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
  <span id="online">–í —Å–µ—Ç–∏: 0</span>
</div>

<div id="onlineList"></div>

<div id="typing">‚úçÔ∏è –∫—Ç–æ-—Ç–æ –ø–µ—á–∞—Ç–∞–µ—Ç‚Ä¶</div>

<script>
// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è (–ª–æ–∫–∞–ª—å–Ω–æ)
function addMessage(text, isSystem = false) {
  const time = new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
  const color = isSystem ? '#777' : '#ffffff';
  const prefix = isSystem ? '[SYSTEM] ' : '';
  document.getElementById('terminal').innerHTML += 
    `<div class="message"><span class="time">[${time}]</span> <span style="color:${color}">${prefix}${text}</span></div>`;
  document.getElementById('terminal').scrollTop = document.getElementById('terminal').scrollHeight;
}

window.addEventListener('load', () => {
  const input = document.getElementById('input');
  const sendBtn = document.getElementById('send-btn');
  const statusEl = document.getElementById('status');

  // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –≤–≤–æ–¥—É
  setTimeout(() => {
    input.focus();
    statusEl.innerHTML = '<span style="color:#0f0">‚óè –ì–æ—Ç–æ–≤ –∫ –≤–≤–æ–¥—É</span>';
    addMessage('–¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å –ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è', true);
  }, 500);

  // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
  function send() {
    const text = input.value.trim();
    if (!text) return;
    addMessage(text);
    input.value = '';
  }

  input.addEventListener('keydown', e => {
    if (e.key === 'Enter') send();
  });

  sendBtn.addEventListener('click', send);

  // –ï—Å–ª–∏ Firebase –∑–∞–≥—Ä—É–∑–∏–ª—Å—è ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è
  if (typeof firebase !== 'undefined') {
    console.log('Firebase SDK –Ω–∞–π–¥–µ–Ω');
    // ... (–≤—Å—Ç–∞–≤—å —Å—é–¥–∞ —Å–≤–æ–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Firebase, online, typing, –¥—Ä—É–∑—å—è, –ª–æ–±–±–∏ –∏ —Ç.–¥.)
    // –ü–æ–∫–∞ –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É, —á—Ç–æ–±—ã —Ç—ã –º–æ–≥ –ø–∏—Å–∞—Ç—å —Å—Ä–∞–∑—É
  } else {
    console.warn('Firebase –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è ‚Äî –ø–∏—à–∏ –ª–æ–∫–∞–ª—å–Ω–æ');
    statusEl.innerHTML = '<span style="color:#f44">Firebase –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω (–±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫?)</span>';
  }
});
</script>
</body>
</html>
